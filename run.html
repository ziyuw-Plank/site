<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>选择位置</title>
<style>
  body { font-family: sans-serif; text-align: center; padding: 40px; background: #f7f7f7; }
  h1 { margin-bottom: 30px; }
  button {
    display: block;
    width: 200px;
    margin: 10px auto;
    padding: 10px;
    font-size: 16px;
    border: none;
    background: #007bff;
    color: white;
    border-radius: 6px;
    cursor: pointer;
  }
  button:hover {
    background: #0056b3;
  }
</style>
</head>
<body>
<h1>选择查询地点</h1>

<button onclick="go(32.100564, 118.911458)">格物楼东侧</button>
<button onclick="go(32.101014, 118.911399)">行建楼东侧</button>
<button onclick="go(32.102296, 118.911095)">学明楼</button>
<button onclick="go(32.102681, 118.912134)">学正楼</button>
<button onclick="go(32.102433, 118.914265)">学海楼东</button>
<button onclick="go(32.102124, 118.913439)">学海楼西</button>
<button onclick="go(32.101316, 118.913393)">厚生楼北</button>

<script>
function go(lat, lon) {
  // 点击按钮后跳转到 run.html，并带上坐标参数
  window.location.href = `run.html?lat=${lat}&lon=${lon}`;
}
</script>

</body>
</html>

┌──(wang㉿wang)-[/var/www/html]
└─> cat run.html
<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>车辆列表</title>
<style>
  body { font-family: sans-serif; background: #f7f7f7; padding: 20px; }
  h1 { text-align: center; }
  h2 { margin-top: 40px; color: #333; }
  table { border-collapse: collapse; width: 100%; margin-top: 10px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background-color: #eee; }
  .number {
    color: #007bff;
    font-weight: bold;
    background: #fff3cd;
    border-radius: 4px;
    padding: 2px 6px;
  }
</style>
</head>
<body>
<h1>车辆信息</h1>
<div id="container">加载中...</div>

<script>
async function loadCars() {
  const container = document.getElementById("container");
  try {
    // 从 URL 中取参数 ?lat=...&lon=...
    const params = new URLSearchParams(window.location.search);
    const lat = params.get("lat") || "32.102078";
    const lon = params.get("lon") || "118.91059";

    // 请求 PHP 接口
    const res = await fetch(`run.php?lat=${lat}&lon=${lon}`);
    const data = await res.json();
    const groups = data?.data || {};

    if (!Object.keys(groups).length) {
      container.innerHTML = "<p>没有车辆数据。</p>";
      return;
    }

    container.innerHTML = "";
    for (const [type, group] of Object.entries(groups)) {
      const cars = group.cars || [];
      const total = group.total || 0;

      const tableHTML = cars.length
        ? `<table>
            <thead>
              <tr>
                <th>ID</th>
                <th>编号（高亮）</th>
                <th>经度</th>
                <th>纬度</th>
                <th>电池</th>
                <th>距离基准点(m)</th>
              </tr>
            </thead>
            <tbody>
              ${cars.map(car => `
                <tr>
                  <td>${car.id}</td>
                  <td class="number">${car.number}</td>
                  <td>${car.longitude}</td>
                  <td>${car.latitude}</td>
                  <td>${car.battery_name || '-'}</td>
                  <td>${car.distance}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>`
        : "<p>暂无数据。</p>";

      container.innerHTML += `
        <h2>${type}（共 ${total} 辆）</h2>
        ${tableHTML}
      `;
    }
  } catch (err) {
    container.innerHTML = `<p>请求失败：${err.message}</p>`;
  }
}

loadCars();
</script>

<br><br>
<h1>解锁成功后请在手机上点击寻车查看具体位置</h1>
</body>
</html>
